# JWT 認証 について説明できる

認証（ログイン）は多くのウェブアプリケーションで必要とされる機能です。

認証を実現するのに一般的に使用されるのが、JWT 認証です。

## 1. 認証とは

認証とは何か、プログラミング初心者にわかるように説明してください。

A. 認証（Authentication）とは、システムがユーザーの身元を確認するプロセスのことです。

これにより、ユーザーは自分がアカウントの所有者であることを証明できます。

## 2. 認証の方法

認証には様々な方法があります。どのような方法があるかを調べ、有名なものを3つ挙げ、その方法及びメリット・デメリットを説明してください。

A. パスワード認証

方法１: ユーザーは自分がアカウントの所有者であることを証明するために、事前に設定したパスワードを入力します。

メリット: 理解しやすく、実装も比較的簡単です。また、ユーザーがパスワードを覚えていれば、どのデバイスからでも認証を行うことができます。

デメリット: パスワードが弱い場合や、パスワードが漏洩した場合、不正なアクセスを許してしまう可能性があります。また、ユーザーがパスワードを忘れてしまうと、アカウントにアクセスできなくなる可能性があります。

二要素認証（2FA）

方法２: パスワードとは別の「第二の要素」（例えば、SMSで送られてくるコードや、認証アプリで生成されるコード）を使用して、ユーザーがアカウントの所有者である事を確認します。

メリット: パスワードだけでなく、第二の要素も必要なため、セキュリティが大幅に強化されます。パスワードが漏洩したとしても、第二の要素がなければ不正なアクセスは防げます。

デメリット: ユーザーが第二の要素を取得するためのデバイス（例えば、携帯電話）を持っていないと、認証ができない場合があります。また、認証の手続きが一手間増えるため、ユーザー体験が若干低下する可能性があります。

方法３:バイオメトリクス認証（生体認証）

方法: ユーザーの生体情報（例えば、指紋や顔認証、虹彩認証など）を使用して、ユーザーがアカウントの所有者であることを確認します。

メリット: ユーザー固有の生体情報を使用するため、非常に高いセキュリティを提供します。さらに、パスワードを覚えておく必要がないため、ユーザー体験も向上します。

デメリット: 生体情報を読み取るための特殊なハードウェア（例えば、指紋スキャナーや顔認識カメラ）が必要で、全てのデバイスにこれらのハードウェアが搭載されているわけではありません。そして、生体情報が何らかの理由で変化した場合（例えば、指を怪我した場合など）、認証ができなくなる可能性があります。さらに、生体情報が漏洩した場合、パスワードのように変更することができないため、その影響は非常に大きいです。

## 3. JWT とは

認証の中でも API においてよく使用されるのが JWT 認証です。
JWT とは何か、プログラミング初心者にわかるように説明してください。

A. JWT（JSON Web Token）は、情報を安全に伝達するためのコンパクトでURLセーフな方法を提供する、オープンスタンダード（RFC 7519）です。

JWTは3つの部分から成り立っています
- ヘッダー（Header）: トークンのタイプと使用している暗号化アルゴリズムを指定します。
- ペイロード（Payload）: トークンに含める情報（クレーム）を指定します。これには、ユーザーの詳細やトークンの有効期限などが含まれます。
- 署名（Signature）: ヘッダーとペイロードを結合し、秘密鍵を使用して署名します。これにより、情報が改ざんされていないことを確認できます。

これら3つの部分はピリオド（.）で連結され、一つの文字列となります。

JWT認証では、ユーザーがログインするとサーバーはJWTを生成し、それをユーザーに返します。ユーザーはそのJWTを保存し、以後のリクエストに対してJWTをリクエストのヘッダーに含めてサーバーに送ります。

サーバーはそのJWTを検証し、有効であればリクエストを処理します。そして、JWTは自己完結型であるため、システム間で簡単に情報を共有できます。


## 4. JWT 認証の流れ

JWT を用いた認証の流れ（どのような流れで認証が行われるのか）を説明してください。その際に、JWT 認証の流れを図 (シーケンス図) にもまとめてください。

[JWT認証のシーケンス図](https://www.notion.so/JWT-4d9571fbed11436694fb9f80bd1dab54?pvs=4)

## 5. JWT 認証のメリット・デメリット

JWT を用いた認証のメリット、デメリットを挙げてください。

A. メリット4つ

ステートレス性: サーバー側にセッション情報を保存する必要がない

自己完結型: JWTは、ペイロード部分に認証情報やその他の情報を含むことができます。これにより、システム間で状態を共有する必要がなく、複数のサービス間で使い回すことが可能です。

強いセキュリティ: JWTは秘密鍵を使用して署名されているため、内容の改ざんが防げます。

クロスドメイン認証: Cookieを使用するとクロスドメインの問題が発生する可能性がありますが、JWTはその制限を受けません。

デメリット4つ

データ暗号化の欠如: JWTは署名を使用してデータの改ざんを防ぎますが、ペイロードの情報は基本的に暗号化されていません。機密性の高い情報は含めないように注意が必要です。

サイズ: JWTは比較的大きいです。これは特にモバイル環境でのデータ使用量に影響を及ぼす可能性があります。

セッション無効化: JWTはステートレスであるため、一度発行されたJWTを無効にすることが難しいです。これはログアウト機能の実装やセキュリティ上の問題に影響を及ぼす可能性があります。

エクスパイア時間の管理: JWTの有効期限を適切に管理しないと、長期間有効なトークンが悪用されるリスクがあります。逆に短すぎるとユーザー体験が低下する可能性があります。